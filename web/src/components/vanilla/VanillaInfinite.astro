---
const { index = 1, class: className, ...rest } = Astro.props
const slides = Array.from({ length: 10 + Math.random() * 10 }, (_, i) => i)
---

<div
  {...rest}
  tabindex="0"
  data-slider="vanilla-infinite"
  class:list={[
    "py-xl flex w-screen overflow-x-hidden",
    className,
    "px-[calc(50%-40vw)] md:px-[calc(50%-15vw)]",
    "focus:outline-none",
  ]}
>
  {
    slides.map((slide, i) => (
      <div class="flex aspect-[3/4] w-[80vw] shrink-0 items-center justify-center p-1 md:w-[30vw]">
        <div class="relative h-full w-full p-8 outline">
          <p class="absolute top-2 left-2 z-10">{i}</p>
          <div data-parallax class="h-full w-full outline outline-gray-800" />
        </div>
      </div>
    ))
  }
</div>

<script>
  import { Slider } from "~/js/slider"

  const s1 = document.querySelector("[data-slider='vanilla-infinite']")

  if (s1) {
    const slider = new Slider(s1, {
      onSlideChange: slide => {
        // console.log("slide", slide)
      },
    })

    /** reset/ -> 4 resize */
    // setTimeout(() => {
    //   slider.isVisible = false
    //   slider.items.forEach(item => {
    //     item.style.transform = `translateX(${0}px)`
    //   })
    // }, 5000)
  }
</script>
